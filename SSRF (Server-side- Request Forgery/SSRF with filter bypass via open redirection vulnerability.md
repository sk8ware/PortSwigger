
Este laboratorio tiene una función de verificación de existencias que obtiene datos de un sistema interno.

Para resolver el laboratorio, cambie la URL de verificación de existencias para acceder a la interfaz de administración en http://192.168.0.12:8080/admin y elimine el usuario carlos.

El verificador de acciones se ha restringido para acceder únicamente a la aplicación local, por lo que primero deberá encontrar una redirección abierta que afecte a la aplicación.

----

En esta ocasión para el ejercicio se encuentra en el botón de **check stock** que nos permite ingresar rutas y en este ejercicio necesita de un open redirect  (**next product**), nos toca aprovechar de otro lado de la web donde la llegues a tensar 

### Check stock

Donde va a recibir la ruta 

![[Pasted image 20241219115256.png]]

### Next Product

Donde se encuentra el open redirect con el que podemos usarlo en la ruta del check stock

![[Pasted image 20241219115538.png]]

así que lo probamos desde la url de la web para ver si efectivamente nos redirigue esa ruta a google:

```
/product/nextProduct?currentProductId=2&path=https://google.es
```

![[Pasted image 20241219115926.png]]

ahora para la vulnerabilidad probamos el path y la dirección ip que nos muestran al principio 

![[Pasted image 20241219120424.png]]

Para que quede de esta manera y por cierto no se olviden de URLcodear el arpersan `&` para no tener problemas al momento de enviar la petición 

![[Pasted image 20241219120745.png]]

Ahora para pasar el nivel debemos filtrar en el **raw** por **delete** para buscar como borrar al usuario **Carlos**

Una vez encontrado debería quedar así y en enviar la petición 

![[Pasted image 20241219121104.png]]

Y listo con eso ya acabaríamos este nivel 

![[Pasted image 20241219121148.png]]